# Penetration Testing MCP Setup Guide

This guide covers setting up MCP servers that enable Claude to agentically perform penetration testing, vulnerability scanning, and security reconnaissance.

## Overview

MCP (Model Context Protocol) servers bridge AI agents like Claude with real security tools. This enables:
- **Autonomous reconnaissance** - Subdomain enumeration, port scanning
- **Vulnerability discovery** - Automated CVE scanning, web app testing
- **Security assessment** - SQL injection, XSS, misconfigurations

## MCP Server Options

### 1. HexStrike AI (Recommended - 150+ Tools)

The most comprehensive option with 150+ cybersecurity tools.

**Features:**
- 150+ Security Tools across 35+ attack categories
- 12+ AI Agents for autonomous workflows
- 4000+ Nuclei vulnerability templates
- Covers: Network, Web App, Cloud, Binary, CTF, OSINT

**Installation:**
```bash
git clone https://github.com/0x4m4/hexstrike-ai.git
cd hexstrike-ai
pip3 install -r requirements.txt
python3 hexstrike_server.py
```

**Claude Desktop Config** (`%APPDATA%\Claude\claude_desktop_config.json`):
```json
{
  "mcpServers": {
    "hexstrike": {
      "command": "python3",
      "args": ["C:/path/to/hexstrike-ai/hexstrike_server.py"]
    }
  }
}
```

**Source:** [HexStrike AI GitHub](https://github.com/0x4m4/hexstrike-ai)

---

### 2. PentestMCP (Docker-based - 20+ Tools)

Containerized solution with OWASP ZAP, Nmap, SQLMap, Nuclei.

**Features:**
- Pre-built Docker image (no local deps)
- Direct ZAP Active Scan control
- SQLMap for injection testing
- Nmap for network discovery

**Installation:**
```bash
docker pull ramgameer/pentest-mcp:latest
```

**Claude Desktop Config:**
```json
{
  "mcpServers": {
    "pentestMCP": {
      "command": "docker",
      "args": [
        "run",
        "--rm",
        "-i",
        "ramgameer/pentest-mcp:latest"
      ]
    }
  }
}
```

**Source:** [PentestMCP GitHub](https://github.com/ramkansal/pentestMCP)

---

### 3. HydraMCP (Lightweight Toolkit)

Lightweight, extensible toolkit for basic scanning.

**Features:**
- Nmap network scanning
- SQLMap injection testing
- Extensible Python interface

**Installation:**
```bash
git clone https://github.com/happyhackingspace/mcp-hydra.git
cd mcp-hydra
docker build -t hydramcp .
```

**Claude Desktop Config:**
```json
{
  "mcpServers": {
    "hydramcp": {
      "command": "docker",
      "args": ["run", "--rm", "-i", "--name", "hydramcp", "hydramcp"]
    }
  }
}
```

**Source:** [HydraMCP on Playbooks.com](https://playbooks.com/mcp/happyhackingspace-hydra-penetration-testing)

---

### 4. Kali MCP Server (Full Kali Tools)

Access to complete Kali Linux toolset via Docker.

**Features:**
- Full Kali Linux environment
- All standard Kali tools available
- Custom command execution

**Installation:**
```bash
docker pull kalilinux/kali-rolling
```

**Tools Available:**
- `nmap` - Network discovery
- `nikto` - Web server scanning
- `whatweb` - Technology fingerprinting
- `sqlmap` - SQL injection
- `gobuster` - Directory brute-forcing

**Source:** [Kali MCP Medium Article](https://medium.com/@sasisachins2003/penetration-testing-made-simple-kali-mcp-with-docker-and-claude-desktop-6d50a6a60300)

---

## Standalone Tools (No MCP)

### OWASP Nettacker

Python-based automated vulnerability scanner.

**Installation:**
```bash
python3 -m venv venv
. venv/bin/activate
pip3 install nettacker
nettacker --help
```

**Features:**
- 100% Python (no external tools)
- Multi-protocol: HTTP, FTP, SSH, SMB, SMTP
- Modular architecture
- Web GUI available

**Usage:**
```bash
# Scan a target
nettacker -i target.com -m all

# Subdomain enumeration
nettacker -i target.com -m subdomain_scan

# Port scanning
nettacker -i target.com -m port_scan
```

**Source:** [OWASP Nettacker GitHub](https://github.com/OWASP/Nettacker)

---

### Nuclei (Template-based Scanner)

Fast vulnerability scanner with 4000+ templates.

**Installation:**
```bash
winget install ProjectDiscovery.Nuclei --source winget
nuclei -update-templates
```

**Usage:**
```bash
# Scan with all templates
nuclei -u https://target.com

# Scan for specific CVEs
nuclei -u https://target.com -t cves/

# Scan for misconfigurations
nuclei -u https://target.com -t misconfigurations/
```

**Source:** [Nuclei GitHub](https://github.com/projectdiscovery/nuclei)

---

## Recommended Setup for License Authority Testing

### Phase 1: Basic Scanning (Immediate)

Add to Claude Code MCP config:

```json
{
  "mcpServers": {
    "pentestMCP": {
      "command": "docker",
      "args": ["run", "--rm", "-i", "ramgameer/pentest-mcp:latest"]
    }
  }
}
```

### Phase 2: Comprehensive Testing (Week 1)

Install HexStrike for full capabilities:

```bash
git clone https://github.com/0x4m4/hexstrike-ai.git
cd hexstrike-ai
pip3 install -r requirements.txt
```

### Phase 3: Continuous Scanning (Ongoing)

Set up automated scanning in CI/CD:
- OWASP Nettacker for scheduled scans
- Nuclei templates for CVE monitoring
- ZAP baseline scans in GitHub Actions

---

## Usage Examples

### With PentestMCP

After configuring Claude Desktop:

```
User: "Scan app-dev.thelicenseauthority.com for open ports"
Claude: [Uses nmap tool via MCP]
       "Found ports 80 (HTTP), 443 (HTTPS) open..."

User: "Check for SQL injection on the login form"
Claude: [Uses sqlmap tool via MCP]
       "Testing authentication endpoint..."
```

### With Nuclei (Direct)

```bash
# Quick vulnerability check
nuclei -u https://app-dev.thelicenseauthority.com -t http/vulnerabilities/

# Full scan with output
nuclei -u https://app-dev.thelicenseauthority.com -o scan_results.txt
```

---

## Security & Ethics

**IMPORTANT:**

1. **Authorization Required** - Only test systems you own or have explicit permission to test
2. **Isolated Environments** - Run against DEV/STAGING, never production without approval
3. **Document Everything** - Log all scans for audit trails
4. **Responsible Disclosure** - Report findings through proper channels

---

## Configuration File Locations

| Platform | Path |
|----------|------|
| Windows | `%APPDATA%\Claude\claude_desktop_config.json` |
| macOS | `~/Library/Application Support/Claude/claude_desktop_config.json` |
| Linux | `~/.config/Claude/claude_desktop_config.json` |

---

## Tool Comparison Matrix

| MCP Server | Tools | Docker | Ease | Coverage |
|------------|-------|--------|------|----------|
| HexStrike AI | 150+ | No | Medium | Comprehensive |
| PentestMCP | 20+ | Yes | Easy | Web/Network |
| HydraMCP | 10+ | Yes | Easy | Basic |
| Kali MCP | All Kali | Yes | Medium | Full Kali |

---

## Sources

- [HexStrike AI GitHub](https://github.com/0x4m4/hexstrike-ai)
- [PentestMCP GitHub](https://github.com/ramkansal/pentestMCP)
- [OWASP Nettacker](https://github.com/OWASP/Nettacker)
- [Nuclei Scanner](https://github.com/projectdiscovery/nuclei)
- [HydraMCP](https://playbooks.com/mcp/happyhackingspace-hydra-penetration-testing)
- [Kali MCP Guide](https://medium.com/@sasisachins2003/penetration-testing-made-simple-kali-mcp-with-docker-and-claude-desktop-6d50a6a60300)
